{"version":3,"sources":["webpack:///./node_modules/@magento/peregrine/lib/talons/CartPage/PriceAdjustments/CouponCode/couponCode.gql.js","webpack:///./node_modules/@magento/peregrine/lib/talons/CartPage/PriceAdjustments/CouponCode/useCouponCode.js","webpack:///./node_modules/@magento/venia-ui/lib/components/CartPage/PriceAdjustments/CouponCode/couponCode.module.css?b47d","webpack:///./node_modules/@magento/venia-ui/lib/components/CartPage/PriceAdjustments/CouponCode/couponCode.js","webpack:///./node_modules/@magento/venia-ui/lib/components/CartPage/PriceAdjustments/CouponCode/index.js","webpack:///./node_modules/@magento/venia-ui/lib/components/LinkButton/linkButton.module.css?e775","webpack:///./node_modules/@magento/venia-ui/lib/components/LinkButton/linkButton.js","webpack:///./node_modules/@magento/venia-ui/lib/components/CartPage/PriceAdjustments/CouponCode/couponCode.module.css","webpack:///./node_modules/@magento/venia-ui/lib/components/LinkButton/linkButton.module.css"],"names":["GET_APPLIED_COUPONS","gql","AppliedCouponsFragment","APPLY_COUPON_MUTATION","CartPageFragment","REMOVE_COUPON_MUTATION","getAppliedCouponsQuery","applyCouponMutation","removeCouponMutation","useCouponCode","props","operations","mergeOperations","DEFAULT_OPERATIONS","setIsCartUpdating","cartId","useCartContext","data","error","fetchError","useQuery","fetchPolicy","nextFetchPolicy","skip","variables","applyCoupon","called","applyCouponCalled","applyError","loading","applyingCoupon","useMutation","removeCoupon","removeCouponCalled","removeCouponError","removingCoupon","handleApplyCoupon","useCallback","couponCode","e","handleRemoveCoupon","useEffect","errors","useMemo","Map","errorIcon","React","createElement","Icon","src","AlertCircleIcon","attrs","width","CouponCode","classes","useStyle","defaultClasses","talonProps","addToast","useToasts","formatMessage","useIntl","deriveErrorMessage","get","type","icon","message","dismissable","timeout","className","errorContainer","FormattedMessage","id","defaultMessage","cart","applied_coupons","codes","map","code","Fragment","key","LinkButton","removeButton","disabled","onClick","appliedCoupon","errorMessage","formClass","entryFormError","entryForm","Form","onSubmit","Field","label","TextInput","field","placeholder","mask","value","trim","maskOnBlur","Button","priority","children","propClasses","restProps","_objectWithoutProperties","_excluded","_extends","root_normalPriority","root","propTypes","shape","string","oneOf","isRequired","defaultProps"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAqC;AAC0B;AACI;AAEnE,MAAMA,mBAAmB,GAAGC,kBAAI;AAChC;AACA;AACA;AACA;AACA;AACA;AACA,MAAMC,yDAAuB;AAC7B,CAAC;AAED,MAAMC,qBAAqB,GAAGF,kBAAI;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMG,iDAAiB;AACvB,CAAC;AAED,MAAMC,sBAAsB,GAAGJ,kBAAI;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMG,iDAAiB;AACvB,CAAC;AAEc;EACXE,sBAAsB,EAAEN,mBAAmB;EAC3CO,mBAAmB,EAAEJ,qBAAqB;EAC1CK,oBAAoB,EAAEH;AAC1B,CAAC,E;;ACtDuD;AACD;AACc;AACE;AACrB;;AAElD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,MAAMI,aAAa,GAAGC,KAAK,IAAI;EAClC,MAAMC,UAAU,GAAGC,uCAAe,CAACC,cAAkB,EAAEH,KAAK,CAACC,UAAU,CAAC;EACxE,MAAM;IACFL,sBAAsB;IACtBC,mBAAmB;IACnBC;EACJ,CAAC,GAAGG,UAAU;EACd,MAAM;IAAEG;EAAkB,CAAC,GAAGJ,KAAK;EAEnC,MAAM,CAAC;IAAEK;EAAO,CAAC,CAAC,GAAGC,sCAAc,EAAE;EACrC,MAAM;IAAEC,IAAI;IAAEC,KAAK,EAAEC;EAAW,CAAC,GAAGC,oCAAQ,CAACd,sBAAsB,EAAE;IACjEe,WAAW,EAAE,mBAAmB;IAChCC,eAAe,EAAE,aAAa;IAC9BC,IAAI,EAAE,CAACR,MAAM;IACbS,SAAS,EAAE;MACPT;IACJ;EACJ,CAAC,CAAC;EAEF,MAAM,CACFU,WAAW,EACX;IACIC,MAAM,EAAEC,iBAAiB;IACzBT,KAAK,EAAEU,UAAU;IACjBC,OAAO,EAAEC;EACb,CAAC,CACJ,GAAGC,0CAAW,CAACxB,mBAAmB,CAAC;EAEpC,MAAM,CACFyB,YAAY,EACZ;IACIN,MAAM,EAAEO,kBAAkB;IAC1Bf,KAAK,EAAEgB,iBAAiB;IACxBL,OAAO,EAAEM;EACb,CAAC,CACJ,GAAGJ,0CAAW,CAACvB,oBAAoB,CAAC;EAErC,MAAM4B,iBAAiB,GAAGC,4BAAW,CACjC,OAAO;IAAEC;EAAW,CAAC,KAAK;IACtB,IAAI,CAACA,UAAU,EAAE;IACjB,IAAI;MACA,MAAMb,WAAW,CAAC;QACdD,SAAS,EAAE;UACPT,MAAM;UACNuB;QACJ;MACJ,CAAC,CAAC;IACN,CAAC,CAAC,OAAOC,CAAC,EAAE;MACR;IAAA;EAER,CAAC,EACD,CAACd,WAAW,EAAEV,MAAM,CAAC,CACxB;EAED,MAAMyB,kBAAkB,GAAGH,4BAAW,CAClC,MAAMC,UAAU,IAAI;IAChB,IAAI;MACA,MAAMN,YAAY,CAAC;QACfR,SAAS,EAAE;UACPT,MAAM;UACNuB;QACJ;MACJ,CAAC,CAAC;IACN,CAAC,CAAC,OAAOC,CAAC,EAAE;MACR;IAAA;EAER,CAAC,EACD,CAACxB,MAAM,EAAEiB,YAAY,CAAC,CACzB;EAEDS,0BAAS,CAAC,MAAM;IACZ,IAAId,iBAAiB,IAAIM,kBAAkB,EAAE;MACzC;MACAnB,iBAAiB,CAACgB,cAAc,IAAIK,cAAc,CAAC;IACvD;EACJ,CAAC,EAAE,CACCR,iBAAiB,EACjBG,cAAc,EACdG,kBAAkB,EAClBE,cAAc,EACdrB,iBAAiB,CACpB,CAAC;;EAEF;EACA,MAAM4B,MAAM,GAAGC,wBAAO,CAClB,MACI,IAAIC,GAAG,CAAC,CACJ,CAAC,wBAAwB,EAAEzB,UAAU,CAAC,EACtC,CAAC,qBAAqB,EAAES,UAAU,CAAC,EACnC,CAAC,sBAAsB,EAAEM,iBAAiB,CAAC,CAC9C,CAAC,EACN,CAACN,UAAU,EAAET,UAAU,EAAEe,iBAAiB,CAAC,CAC9C;EAED,OAAO;IACHJ,cAAc;IACdb,IAAI;IACJyB,MAAM;IACNN,iBAAiB;IACjBI,kBAAkB;IAClBL;EACJ,CAAC;AACL,CAAC;;AAED;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3K8F;AAC9F,YAA0K;;AAE1K,eAAe;;AAEf;AACA;;AAEA,aAAa,kCAAG,CAAC,oCAAO;;;;AAIT,qGAAO,aAAa,E;;ACZgB;AACI;AACQ;AAChB;AACqC;AAC6B;AAEjE;AAEX;AACL;AACG;AACF;AACY;AACF;AAEU;AAErD,MAAMU,SAAS,gBACXC,eAAA,CAAAC,aAAA,CAACC,uBAAI;EACDC,GAAG,EAAEC,+BAAgB;EACrBC,KAAK,EAAE;IACHC,KAAK,EAAE;EACX;AAAE,EAET;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMC,UAAU,GAAG3C,KAAK,IAAI;EACxB,MAAM4C,OAAO,GAAGC,uCAAQ,CAACC,4BAAc,EAAE9C,KAAK,CAAC4C,OAAO,CAAC;EAEvD,MAAMG,UAAU,GAAGhD,aAAa,CAAC;IAC7BK,iBAAiB,EAAEJ,KAAK,CAACI;EAC7B,CAAC,CAAC;EACF,MAAM,GAAG;IAAE4C;EAAS,CAAC,CAAC,GAAGC,sCAAS,EAAE;EACpC,MAAM;IACF7B,cAAc;IACdb,IAAI;IACJyB,MAAM;IACNN,iBAAiB;IACjBI,kBAAkB;IAClBL;EACJ,CAAC,GAAGsB,UAAU;EACd,MAAM;IAAEG;EAAc,CAAC,GAAGC,kCAAO,EAAE;EAEnC,MAAM3B,iBAAiB,GAAG4B,wDAAkB,CAAC,CACzCpB,MAAM,CAACqB,GAAG,CAAC,sBAAsB,CAAC,CACrC,CAAC;EAEFtB,0BAAS,CAAC,MAAM;IACZ,IAAIP,iBAAiB,EAAE;MACnBwB,QAAQ,CAAC;QACLM,IAAI,EAAE,OAAO;QACbC,IAAI,EAAEpB,SAAS;QACfqB,OAAO,EAAEhC,iBAAiB;QAC1BiC,WAAW,EAAE,IAAI;QACjBC,OAAO,EAAE;MACb,CAAC,CAAC;IACN;EACJ,CAAC,EAAE,CAACV,QAAQ,EAAExB,iBAAiB,CAAC,CAAC;EAEjC,IAAI,CAACjB,IAAI,EAAE;IACP,OAAO,IAAI;EACf;EAEA,IAAIyB,MAAM,CAACqB,GAAG,CAAC,wBAAwB,CAAC,EAAE;IACtC,oBACIjB,eAAA,CAAAC,aAAA;MAAKsB,SAAS,EAAEf,OAAO,CAACgB;IAAe,gBACnCxB,eAAA,CAAAC,aAAA,CAACwB,0BAAgB;MACbC,EAAE,EAAE,2BAA4B;MAChCC,cAAc,EACV;IACH,EACH,CACA;EAEd;EAEA,IAAIxD,IAAI,CAACyD,IAAI,CAACC,eAAe,EAAE;IAC3B,MAAMC,KAAK,GAAG3D,IAAI,CAACyD,IAAI,CAACC,eAAe,CAACE,GAAG,CAAC,CAAC;MAAEC;IAAK,CAAC,KAAK;MACtD,oBACIhC,eAAA,CAAAC,aAAA,CAACgC,iBAAQ;QAACC,GAAG,EAAEF;MAAK,gBAChBhC,eAAA,CAAAC,aAAA,eAAO+B,IAAI,CAAQ,eACnBhC,eAAA,CAAAC,aAAA,CAACkC,6BAAU;QACPZ,SAAS,EAAEf,OAAO,CAAC4B,YAAa;QAChCC,QAAQ,EAAEhD,cAAe;QACzB,WAAQ,+BAA+B;QACvCiD,OAAO,EAAEA,CAAA,KAAM;UACX5C,kBAAkB,CAACsC,IAAI,CAAC;QAC5B;MAAE,gBAEFhC,eAAA,CAAAC,aAAA,CAACwB,0BAAgB;QACbC,EAAE,EAAE,yBAA0B;QAC9BC,cAAc,EAAE;MAAS,EAC3B,CACO,CACN;IAEnB,CAAC,CAAC;IAEF,oBAAO3B,eAAA,CAAAC,aAAA;MAAKsB,SAAS,EAAEf,OAAO,CAAC+B;IAAc,GAAET,KAAK,CAAO;EAC/D,CAAC,MAAM;IACH,MAAMU,YAAY,GAAGxB,wDAAkB,CAAC,CACpCpB,MAAM,CAACqB,GAAG,CAAC,qBAAqB,CAAC,CACpC,CAAC;IAEF,MAAMwB,SAAS,GAAGD,YAAY,GACxBhC,OAAO,CAACkC,cAAc,GACtBlC,OAAO,CAACmC,SAAS;IAEvB,oBACI3C,eAAA,CAAAC,aAAA,CAAC2C,mBAAI;MACD,WAAQ,iBAAiB;MACzBrB,SAAS,EAAEkB,SAAU;MACrBI,QAAQ,EAAEvD;IAAkB,gBAE5BU,eAAA,CAAAC,aAAA,CAAC6C,wBAAK;MACFpB,EAAE,EAAC,YAAY;MACfqB,KAAK,EAAEjC,aAAa,CAAC;QACjBY,EAAE,EAAE,qBAAqB;QACzBC,cAAc,EAAE;MACpB,CAAC;IAAE,gBAEH3B,eAAA,CAAAC,aAAA,CAAC+C,4BAAS;MACNC,KAAK,EAAC,YAAY;MAClBvB,EAAE,EAAE,YAAa;MACjB,WAAQ,uBAAuB;MAC/BwB,WAAW,EAAEpC,aAAa,CAAC;QACvBY,EAAE,EAAE,sBAAsB;QAC1BC,cAAc,EAAE;MACpB,CAAC,CAAE;MACHwB,IAAI,EAAEC,KAAK,IAAIA,KAAK,IAAIA,KAAK,CAACC,IAAI,EAAG;MACrCC,UAAU,EAAE,IAAK;MACjBlC,OAAO,EAAEoB;IAAa,EACxB,CACE,eACRxC,eAAA,CAAAC,aAAA,CAAC6C,wBAAK,qBACF9C,eAAA,CAAAC,aAAA,CAACsD,gCAAM;MACH,WAAQ,mBAAmB;MAC3BlB,QAAQ,EAAErD,cAAe;MACzBwE,QAAQ,EAAE,QAAS;MACnBtC,IAAI,EAAE;IAAS,gBAEflB,eAAA,CAAAC,aAAA,CAACwB,0BAAgB;MACbC,EAAE,EAAE,kBAAmB;MACvBC,cAAc,EAAE;IAAQ,EAC1B,CACG,CACL,CACL;EAEf;AACJ,CAAC;AAEcpB,oFAAU,E;;;;;;;;;;;;;;ACxKzB;AAAA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAwF;AACxF,YAA8J;;AAE9J,eAAe;;AAEf;AACA;;AAEA,aAAa,kCAAG,CAAC,oCAAO;;;;AAIT,qGAAO,aAAa,E;;;;;;;;;ACZT;AACwB;AAER;AACW;AACtB;;AAE/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM4B,UAAU,GAAGvE,KAAK,IAAI;EACxB,MAAM;MAAE6F,QAAQ;MAAEjD,OAAO,EAAEkD,WAAW;MAAExC;IAAmB,CAAC,GAAGtD,KAAK;IAAnB+F,SAAS,GAAAC,wBAAA,CAAKhG,KAAK,EAAAiG,SAAA;EACpE,MAAMrD,OAAO,GAAGC,uCAAQ,CAACC,4BAAc,EAAEgD,WAAW,CAAC;EAErD,oBACI1D,eAAA,CAAAC,aAAA,CAACsD,gCAAM,EAAAO,QAAA;IACHN,QAAQ,EAAE,QAAS;IACnBhD,OAAO,EAAE;MAAEuD,mBAAmB,EAAEvD,OAAO,CAACwD;IAAK,CAAE;IAC/C9C,IAAI,EAAEA;EAAK,GACPyC,SAAS,GAEZF,QAAQ,CACJ;AAEjB,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAtB,UAAU,CAAC8B,SAAS,GAAG;EACnBzD,OAAO,EAAE0D,2BAAK,CAAC;IACXF,IAAI,EAAEG,oBAAMA;EAChB,CAAC,CAAC;EACFjD,IAAI,EAAEkD,2BAAK,CAAC,CAAC,QAAQ,EAAE,OAAO,EAAE,QAAQ,CAAC,CAAC,CAACC;AAC/C,CAAC;AAEDlC,UAAU,CAACmC,YAAY,GAAG;EACtBpD,IAAI,EAAE;AACV,CAAC;AAEciB,oFAAU,E;;;;;;;;;;;;;;ACtDzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAC2H;AAC7B;AACyG;AACvM,8BAA8B,sEAA2B,CAAC,yFAAqC;AAC/F,0BAA0B,mJAA8B;AACxD;AACA,8BAA8B,QAAS,+FAA+F,GAAG,mDAAmD,sEAAsE,sEAAsE,sCAAsC,OAAO,GAAG,0EAA0E,4CAA4C,8DAA8D,GAAG,gFAAgF,+CAA+C,+DAA+D,GAAG,sEAAsE,0CAA0C,qDAAqD,6CAA6C,0BAA0B,GAAG,oCAAoC,+EAA+E,sEAAsE,GAAG,SAAS,kLAAkL,OAAO,MAAM,YAAY,MAAM,MAAM,YAAY,aAAa,aAAa,MAAM,MAAM,YAAY,MAAM,YAAY,aAAa,OAAO,YAAY,MAAM,YAAY,aAAa,OAAO,YAAY,MAAM,YAAY,aAAa,aAAa,aAAa,OAAO,KAAK,YAAY,OAAO,YAAY,MAAM,uFAAuF,qCAAqC,iCAAiC,+CAA+C,GAAG,mDAAmD,wCAAwC,sEAAsE,sCAAsC,OAAO,GAAG,2DAA2D,4CAA4C,8DAA8D,GAAG,iEAAiE,+CAA+C,+DAA+D,GAAG,uDAAuD,0CAA0C,qDAAqD,6CAA6C,0BAA0B,GAAG,qBAAqB,2CAA2C,8GAA8G,uCAAuC,GAAG,uDAAuD,sEAAsE,oCAAoC,GAAG,qBAAqB;AACl/F;AACA;AACA;AACA;AACA;AACA,kDAAkD,mJAA8B;AAChF;AACe,gFAAuB,EAAC;;;;;;;;;;;;;;;ACfvC;AAAA;AAAA;AAAA;AAAA;AAAA;AACqH;AAC7B;AACiF;AACzK,8BAA8B,sEAA2B,CAAC,yFAAqC;AAC/F,0BAA0B,uIAA8B;AACxD;AACA,8BAA8B,QAAS,yBAAyB,GAAG,SAAS,iJAAiJ,gCAAgC,oDAAoD,4CAA4C,0CAA0C,uCAAuC,8CAA8C,4CAA4C,sCAAsC,sDAAsD,GAAG,qBAAqB;AAC5nB;AACA;AACA,kCAAkC,uIAA8B;AAChE;AACe,gFAAuB,EAAC","file":"4.js","sourcesContent":["import { gql } from '@apollo/client';\nimport { CartPageFragment } from '../../cartPageFragments.gql';\nimport { AppliedCouponsFragment } from './couponCodeFragments.gql';\n\nconst GET_APPLIED_COUPONS = gql`\n    query getAppliedCoupons($cartId: String!) {\n        cart(cart_id: $cartId) {\n            id\n            ...AppliedCouponsFragment\n        }\n    }\n    ${AppliedCouponsFragment}\n`;\n\nconst APPLY_COUPON_MUTATION = gql`\n    mutation applyCouponToCart($cartId: String!, $couponCode: String!) {\n        applyCouponToCart(\n            input: { cart_id: $cartId, coupon_code: $couponCode }\n        ) {\n            cart {\n                id\n                ...CartPageFragment\n                # If this mutation causes \"free\" to become available we need to know.\n                available_payment_methods {\n                    code\n                    title\n                }\n            }\n        }\n    }\n    ${CartPageFragment}\n`;\n\nconst REMOVE_COUPON_MUTATION = gql`\n    mutation removeCouponFromCart($cartId: String!) {\n        removeCouponFromCart(input: { cart_id: $cartId }) {\n            cart {\n                id\n                ...CartPageFragment\n                # If this mutation causes \"free\" to become available we need to know.\n                available_payment_methods {\n                    code\n                    title\n                }\n            }\n        }\n    }\n    ${CartPageFragment}\n`;\n\nexport default {\n    getAppliedCouponsQuery: GET_APPLIED_COUPONS,\n    applyCouponMutation: APPLY_COUPON_MUTATION,\n    removeCouponMutation: REMOVE_COUPON_MUTATION\n};\n","import { useCallback, useEffect, useMemo } from 'react';\nimport { useMutation, useQuery } from '@apollo/client';\nimport { useCartContext } from '@magento/peregrine/lib/context/cart';\nimport mergeOperations from '@magento/peregrine/lib/util/shallowMerge';\nimport DEFAULT_OPERATIONS from './couponCode.gql';\n\n/**\n * This talon contains the logic for a coupon code form component.\n * It performs effects and returns props data for rendering the component.\n *\n * This talon performs the following effects:\n *\n * - Fetch all coupons associated with the cart\n * - Manage the updating state of the cart while a coupon is being applied or removed\n *\n * @function\n *\n * @param {Object} props\n * @param {function} props.setIsCartUpdating Callback function for setting the update state for the cart.\n * @param {CouponCodeMutations} props.mutations GraphQL mutations for a cart's coupon code.\n * @param {CouponCodeQueries} props.queries GraphQL queries for a cart's coupon code.\n *\n * @return {CouponCodeTalonProps}\n *\n * @example <caption>Importing into your project</caption>\n * import { useCouponCode } from '@magento/peregrine/lib/talons/CartPage/PriceAdjustments/CouponCode/useCouponCode';\n */\nexport const useCouponCode = props => {\n    const operations = mergeOperations(DEFAULT_OPERATIONS, props.operations);\n    const {\n        getAppliedCouponsQuery,\n        applyCouponMutation,\n        removeCouponMutation\n    } = operations;\n    const { setIsCartUpdating } = props;\n\n    const [{ cartId }] = useCartContext();\n    const { data, error: fetchError } = useQuery(getAppliedCouponsQuery, {\n        fetchPolicy: 'cache-and-network',\n        nextFetchPolicy: 'cache-first',\n        skip: !cartId,\n        variables: {\n            cartId\n        }\n    });\n\n    const [\n        applyCoupon,\n        {\n            called: applyCouponCalled,\n            error: applyError,\n            loading: applyingCoupon\n        }\n    ] = useMutation(applyCouponMutation);\n\n    const [\n        removeCoupon,\n        {\n            called: removeCouponCalled,\n            error: removeCouponError,\n            loading: removingCoupon\n        }\n    ] = useMutation(removeCouponMutation);\n\n    const handleApplyCoupon = useCallback(\n        async ({ couponCode }) => {\n            if (!couponCode) return;\n            try {\n                await applyCoupon({\n                    variables: {\n                        cartId,\n                        couponCode\n                    }\n                });\n            } catch (e) {\n                // Error is logged by apollo link - no need to double log.\n            }\n        },\n        [applyCoupon, cartId]\n    );\n\n    const handleRemoveCoupon = useCallback(\n        async couponCode => {\n            try {\n                await removeCoupon({\n                    variables: {\n                        cartId,\n                        couponCode\n                    }\n                });\n            } catch (e) {\n                // Error is logged by apollo link - no need to double log.\n            }\n        },\n        [cartId, removeCoupon]\n    );\n\n    useEffect(() => {\n        if (applyCouponCalled || removeCouponCalled) {\n            // If a coupon mutation is in flight, tell the cart.\n            setIsCartUpdating(applyingCoupon || removingCoupon);\n        }\n    }, [\n        applyCouponCalled,\n        applyingCoupon,\n        removeCouponCalled,\n        removingCoupon,\n        setIsCartUpdating\n    ]);\n\n    // Create a memoized error map and toggle individual errors when they change\n    const errors = useMemo(\n        () =>\n            new Map([\n                ['getAppliedCouponsQuery', fetchError],\n                ['applyCouponMutation', applyError],\n                ['removeCouponMutation', removeCouponError]\n            ]),\n        [applyError, fetchError, removeCouponError]\n    );\n\n    return {\n        applyingCoupon,\n        data,\n        errors,\n        handleApplyCoupon,\n        handleRemoveCoupon,\n        removingCoupon\n    };\n};\n\n/** JSDocs type definitions */\n\n/**\n * GraphQL mutations for a cart's coupon code.\n * This is a type used by the {@link useCouponCode} talon.\n *\n * @typedef {Object} CouponCodeMutations\n *\n * @property {GraphQLAST} applyCouponMutation Mutation for applying a coupon code to a cart.\n * @property {GraphQLAST} removeCouponMutation Mutation for removing a coupon code from a cart.\n *\n * @see [CouponCode.js]{@link https://github.com/magento/pwa-studio/blob/develop/packages/venia-ui/lib/components/CartPage/PriceAdjustments/CouponCode/couponCode.js}\n * for the queries used Venia\n */\n\n/**\n * GraphQL queries for a cart's coupon code.\n * This is a type used by the {@link useCouponCode} talon.\n *\n * @typedef {Object} CouponCodeQueries\n *\n * @property {GraphQLAST} getAppliedCouponsQuery Query to fetch the currently applied coupons for a cart.\n *\n * @see [CouponCode.js]{@link https://github.com/magento/pwa-studio/blob/develop/packages/venia-ui/lib/components/CartPage/PriceAdjustments/CouponCode/couponCode.js}\n * for the queries used Venia\n */\n\n/**\n * Object type returned by the {@link useCouponCode} talon.\n * It provides props data to use when rendering a coupon code component.\n *\n * @typedef {Object} CouponCodeTalonProps\n *\n * @property {boolean} applyingCoupon True if a coupon is currently being applied. False otherwise.\n * @property {Object} data Data returned from the `getAppliedCouponsQuery`.\n * @property {String} errorMessage If GraphQL error occurs, this value is set.\n * @property {Object} fetchError The error data object returned by a GraphQL query.\n * @property {function} handleApplyCoupon Function to call for handling the application of a coupon code to a cart.\n * @property {function} handleRemoveCoupon Function to call for handling the removal of a coupon code from a cart\n * @property {boolean} removingCoupon True if a coupon code is currently being removed. False otherwise.\n */\n","import api from \"!../../../../../../../style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../../../../../../css-loader/dist/cjs.js??ref--6-oneOf-0-1!../../../../../../../postcss-loader/dist/cjs.js!./couponCode.module.css\";\n\nvar options = {\"injectType\":\"styleTag\"};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import React, { Fragment, useEffect } from 'react';\nimport { FormattedMessage, useIntl } from 'react-intl';\nimport { AlertCircle as AlertCircleIcon } from 'react-feather';\nimport { useToasts } from '@magento/peregrine';\nimport { deriveErrorMessage } from '@magento/peregrine/lib/util/deriveErrorMessage';\nimport { useCouponCode } from '@magento/peregrine/lib/talons/CartPage/PriceAdjustments/CouponCode/useCouponCode';\n\nimport { useStyle } from '../../../../classify';\n\nimport Button from '../../../Button';\nimport { Form } from 'informed';\nimport Field from '../../../Field';\nimport Icon from '../../../Icon';\nimport LinkButton from '../../../LinkButton';\nimport TextInput from '../../../TextInput';\n\nimport defaultClasses from './couponCode.module.css';\n\nconst errorIcon = (\n    <Icon\n        src={AlertCircleIcon}\n        attrs={{\n            width: 18\n        }}\n    />\n);\n\n/**\n * A child component of the PriceAdjustments component.\n * This component renders a form for addingg a coupon code to the cart.\n *\n * @param {Object} props\n * @param {Function} props.setIsCartUpdating Function for setting the updating state for the cart.\n * @param {Object} props.classes CSS className overrides.\n * See [couponCode.module.css]{@link https://github.com/magento/pwa-studio/blob/develop/packages/venia-ui/lib/components/CartPage/PriceAdjustments/CouponCode/couponCode.module.css}\n * for a list of classes you can override.\n *\n * @returns {React.Element}\n *\n * @example <caption>Importing into your project</caption>\n * import CouponCode from \"@magento/venia-ui/lib/components/CartPage/PriceAdjustments/CouponCode\";\n */\nconst CouponCode = props => {\n    const classes = useStyle(defaultClasses, props.classes);\n\n    const talonProps = useCouponCode({\n        setIsCartUpdating: props.setIsCartUpdating\n    });\n    const [, { addToast }] = useToasts();\n    const {\n        applyingCoupon,\n        data,\n        errors,\n        handleApplyCoupon,\n        handleRemoveCoupon,\n        removingCoupon\n    } = talonProps;\n    const { formatMessage } = useIntl();\n\n    const removeCouponError = deriveErrorMessage([\n        errors.get('removeCouponMutation')\n    ]);\n\n    useEffect(() => {\n        if (removeCouponError) {\n            addToast({\n                type: 'error',\n                icon: errorIcon,\n                message: removeCouponError,\n                dismissable: true,\n                timeout: 10000\n            });\n        }\n    }, [addToast, removeCouponError]);\n\n    if (!data) {\n        return null;\n    }\n\n    if (errors.get('getAppliedCouponsQuery')) {\n        return (\n            <div className={classes.errorContainer}>\n                <FormattedMessage\n                    id={'couponCode.errorContainer'}\n                    defaultMessage={\n                        'Something went wrong. Please refresh and try again.'\n                    }\n                />\n            </div>\n        );\n    }\n\n    if (data.cart.applied_coupons) {\n        const codes = data.cart.applied_coupons.map(({ code }) => {\n            return (\n                <Fragment key={code}>\n                    <span>{code}</span>\n                    <LinkButton\n                        className={classes.removeButton}\n                        disabled={removingCoupon}\n                        data-cy=\"CouponCode-removeCouponButton\"\n                        onClick={() => {\n                            handleRemoveCoupon(code);\n                        }}\n                    >\n                        <FormattedMessage\n                            id={'couponCode.removeButton'}\n                            defaultMessage={'Remove'}\n                        />\n                    </LinkButton>\n                </Fragment>\n            );\n        });\n\n        return <div className={classes.appliedCoupon}>{codes}</div>;\n    } else {\n        const errorMessage = deriveErrorMessage([\n            errors.get('applyCouponMutation')\n        ]);\n\n        const formClass = errorMessage\n            ? classes.entryFormError\n            : classes.entryForm;\n\n        return (\n            <Form\n                data-cy=\"CouponCode-form\"\n                className={formClass}\n                onSubmit={handleApplyCoupon}\n            >\n                <Field\n                    id=\"couponCode\"\n                    label={formatMessage({\n                        id: 'cartPage.couponCode',\n                        defaultMessage: 'Coupon Code'\n                    })}\n                >\n                    <TextInput\n                        field=\"couponCode\"\n                        id={'couponCode'}\n                        data-cy=\"CouponCode-couponCode\"\n                        placeholder={formatMessage({\n                            id: 'couponCode.enterCode',\n                            defaultMessage: 'Enter code'\n                        })}\n                        mask={value => value && value.trim()}\n                        maskOnBlur={true}\n                        message={errorMessage}\n                    />\n                </Field>\n                <Field>\n                    <Button\n                        data-cy=\"CouponCode-submit\"\n                        disabled={applyingCoupon}\n                        priority={'normal'}\n                        type={'submit'}\n                    >\n                        <FormattedMessage\n                            id={'couponCode.apply'}\n                            defaultMessage={'Apply'}\n                        />\n                    </Button>\n                </Field>\n            </Form>\n        );\n    }\n};\n\nexport default CouponCode;\n","export { default } from './couponCode';\n","import api from \"!../../../../../style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../../../../css-loader/dist/cjs.js??ref--6-oneOf-0-1!../../../../../postcss-loader/dist/cjs.js!./linkButton.module.css\";\n\nvar options = {\"injectType\":\"styleTag\"};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import React from 'react';\nimport { oneOf, shape, string } from 'prop-types';\n\nimport { useStyle } from '../../classify';\nimport defaultClasses from './linkButton.module.css';\nimport Button from '../Button';\n\n/**\n * A component for link buttons.\n *\n * @typedef LinkButton\n * @kind functional component\n *\n * @param {props} props React component props\n *\n * @returns {React.Element} A React component that displays a single link button.\n */\nconst LinkButton = props => {\n    const { children, classes: propClasses, type, ...restProps } = props;\n    const classes = useStyle(defaultClasses, propClasses);\n\n    return (\n        <Button\n            priority={'normal'}\n            classes={{ root_normalPriority: classes.root }}\n            type={type}\n            {...restProps}\n        >\n            {children}\n        </Button>\n    );\n};\n\n/**\n * Props for {@link Button}\n *\n * @typedef props\n *\n * @property {Object} classes An object containing the class names for the\n * Button component.\n * @property {string} classes.root classes for root container\n * @property {string} type the type of the Button\n */\nLinkButton.propTypes = {\n    classes: shape({\n        root: string\n    }),\n    type: oneOf(['button', 'reset', 'submit']).isRequired\n};\n\nLinkButton.defaultProps = {\n    type: 'button'\n};\n\nexport default LinkButton;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../../../../css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../../../css-loader/dist/runtime/api.js\";\nimport ___CSS_LOADER_ICSS_IMPORT_0___ from \"-!../../../../../../../css-loader/dist/cjs.js??ref--6-oneOf-0-1!../../../../../../../postcss-loader/dist/cjs.js!../../../LinkButton/linkButton.module.css\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_ICSS_IMPORT_0___, \"\", true);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"/* Styles for \\\"add\\\" view. */\\n.couponCode-entryForm-a6A,\\n.couponCode-entryFormError-ZLm {\\n}\\n\\n/* on mobile... */\\n@media (max-width: 959px) {\\n    .couponCode-entryForm-a6A,\\n    .couponCode-entryFormError-ZLm {\\n        /* switch to rows. */\\n        grid-template-columns: unset;\\n        grid-template-rows: 1fr 1fr;\\n    }\\n}\\n\\n/* TODO @TW: cannot compose */\\n.couponCode-entryFormError-ZLm input {\\n    /* composes: border-error from global; */\\n    border-color: rgb(var(--venia-global-color-red-400));\\n}\\n\\n/* TODO @TW: cannot compose */\\n.couponCode-entryFormError-ZLm input:focus {\\n    /* composes: border-gray-600 from global; */\\n    border-color: rgb(var(--venia-global-color-gray-600));\\n}\\n\\n/* TODO @TW: cannot compose */\\n.couponCode-entryFormError-ZLm p {\\n    /* composes: text-error from global; */\\n    color: rgb(var(--venia-global-color-error));\\n    /* composes: font-semibold from global; */\\n    font-weight: 600;\\n}\\n\\n.couponCode-errorContainer-GWW {\\n    /* Duplicate the left/right/bottom padding on the accordion section */\\n}\\n\\n/* Styles for \\\"removal\\\" view. */\\n.couponCode-removeButton-E4y {\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./node_modules/@magento/venia-ui/lib/components/CartPage/PriceAdjustments/CouponCode/couponCode.module.css\"],\"names\":[],\"mappings\":\"AAAA,2BAA2B;AAC3B;;AAKA;;AAEA,iBAAiB;AACjB;IACI;;QAEI,oBAAoB;QACpB,4BAA4B;QAC5B,2BAA2B;IAC/B;AACJ;;AAEA,6BAA6B;AAC7B;IACI,wCAAwC;IACxC,oDAAoD;AACxD;;AAEA,6BAA6B;AAC7B;IACI,2CAA2C;IAC3C,qDAAqD;AACzD;;AAEA,6BAA6B;AAC7B;IACI,sCAAsC;IACtC,2CAA2C;IAC3C,yCAAyC;IACzC,gBAAgB;AACpB;;AAEA;IAEI,qEAAqE;AAGzE;;AAEA,+BAA+B;AAC/B;AAIA\",\"sourcesContent\":[\"/* Styles for \\\"add\\\" view. */\\n.entryForm,\\n.entryFormError {\\n    composes: gap-x-sm from global;\\n    composes: grid from global;\\n    composes: grid-cols-autoLast from global;\\n}\\n\\n/* on mobile... */\\n@media (max-width: 959px) {\\n    .entryForm,\\n    .entryFormError {\\n        /* switch to rows. */\\n        grid-template-columns: unset;\\n        grid-template-rows: 1fr 1fr;\\n    }\\n}\\n\\n/* TODO @TW: cannot compose */\\n.entryFormError input {\\n    /* composes: border-error from global; */\\n    border-color: rgb(var(--venia-global-color-red-400));\\n}\\n\\n/* TODO @TW: cannot compose */\\n.entryFormError input:focus {\\n    /* composes: border-gray-600 from global; */\\n    border-color: rgb(var(--venia-global-color-gray-600));\\n}\\n\\n/* TODO @TW: cannot compose */\\n.entryFormError p {\\n    /* composes: text-error from global; */\\n    color: rgb(var(--venia-global-color-error));\\n    /* composes: font-semibold from global; */\\n    font-weight: 600;\\n}\\n\\n.errorContainer {\\n    composes: leading-normal from global;\\n    /* Duplicate the left/right/bottom padding on the accordion section */\\n    composes: pt-sm from global;\\n    composes: text-error from global;\\n}\\n\\n/* Styles for \\\"removal\\\" view. */\\n.removeButton {\\n    composes: root from '../../../LinkButton/linkButton.module.css';\\n\\n    composes: ml-xs from global;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"entryForm\": \"couponCode-entryForm-a6A gap-x-sm grid grid-cols-autoLast\",\n\t\"entryFormError\": \"couponCode-entryFormError-ZLm gap-x-sm grid grid-cols-autoLast\",\n\t\"errorContainer\": \"couponCode-errorContainer-GWW leading-normal pt-sm text-error\",\n\t\"removeButton\": \"couponCode-removeButton-E4y \" + ___CSS_LOADER_ICSS_IMPORT_0___.locals[\"root\"] + \" ml-xs\"\n};\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../../css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../../css-loader/dist/runtime/api.js\";\nimport ___CSS_LOADER_ICSS_IMPORT_0___ from \"-!../../../../../css-loader/dist/cjs.js??ref--6-oneOf-0-1!../../../../../postcss-loader/dist/cjs.js!../clickable.module.css\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n___CSS_LOADER_EXPORT___.i(___CSS_LOADER_ICSS_IMPORT_0___, \"\", true);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".linkButton-root-HUs {\\n}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./node_modules/@magento/venia-ui/lib/components/LinkButton/linkButton.module.css\"],\"names\":[],\"mappings\":\"AAAA;AAWA\",\"sourcesContent\":[\".root {\\n    composes: root from '../clickable.module.css';\\n\\n    composes: font-semibold from global;\\n    composes: leading-tight from global;\\n    composes: max-w-full from global;\\n    composes: text-colorDefault from global;\\n    composes: text-brand-dark from global;\\n    composes: underline from global;\\n\\n    composes: hover_text-colorDefault from global;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"root\": \"linkButton-root-HUs \" + ___CSS_LOADER_ICSS_IMPORT_0___.locals[\"root\"] + \" font-semibold leading-tight max-w-full text-colorDefault text-brand-dark underline hover_text-colorDefault\"\n};\nexport default ___CSS_LOADER_EXPORT___;\n"],"sourceRoot":""}